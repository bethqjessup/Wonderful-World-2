(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{223:function(e,t,r){var n=r(13);e.exports=function(e,t){if(!n(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},231:function(e,t,r){"use strict";var n=r(14).f,o=r(53),l=r(92),c=r(32),h=r(91),d=r(153),f=r(117),m=r(156),v=r(94),T=r(11),y=r(152).fastKey,M=r(223),S=T?"_s":"size",R=function(e,t){var r,n=y(t);if("F"!==n)return e._i[n];for(r=e._f;r;r=r.n)if(r.k==t)return r};e.exports={getConstructor:function(e,t,r,f){var m=e((function(e,n){h(e,m,t,"_i"),e._t=t,e._i=o(null),e._f=void 0,e._l=void 0,e[S]=0,null!=n&&d(n,r,e[f],e)}));return l(m.prototype,{clear:function(){for(var e=M(this,t),data=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete data[r.i];e._f=e._l=void 0,e[S]=0},delete:function(e){var r=M(this,t),n=R(r,e);if(n){var o=n.n,l=n.p;delete r._i[n.i],n.r=!0,l&&(l.n=o),o&&(o.p=l),r._f==n&&(r._f=o),r._l==n&&(r._l=l),r[S]--}return!!n},forEach:function(e){M(this,t);for(var r,n=c(e,arguments.length>1?arguments[1]:void 0,3);r=r?r.n:this._f;)for(n(r.v,r.k,this);r&&r.r;)r=r.p},has:function(e){return!!R(M(this,t),e)}}),T&&n(m.prototype,"size",{get:function(){return M(this,t)[S]}}),m},def:function(e,t,r){var n,o,l=R(e,t);return l?l.v=r:(e._l=l={i:o=y(t,!0),k:t,v:r,p:n=e._l,n:void 0,r:!1},e._f||(e._f=l),n&&(n.n=l),e[S]++,"F"!==o&&(e._i[o]=l)),e},getEntry:R,setStrong:function(e,t,r){f(e,t,(function(e,r){this._t=M(e,t),this._k=r,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?m(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,m(1))}),r?"entries":"values",!r,!0),v(t)}}},232:function(e,t,r){"use strict";var n=r(6),o=r(5),l=r(23),c=r(92),meta=r(152),h=r(153),d=r(91),f=r(13),m=r(12),v=r(93),T=r(52),y=r(118);e.exports=function(e,t,r,M,S,R){var _=n[e],x=_,L=S?"set":"add",E=x&&x.prototype,w={},A=function(e){var t=E[e];l(E,e,"delete"==e||"has"==e?function(a){return!(R&&!f(a))&&t.call(this,0===a?0:a)}:"get"==e?function(a){return R&&!f(a)?void 0:t.call(this,0===a?0:a)}:"add"==e?function(a){return t.call(this,0===a?0:a),this}:function(a,b){return t.call(this,0===a?0:a,b),this})};if("function"==typeof x&&(R||E.forEach&&!m((function(){(new x).entries().next()})))){var I=new x,C=I[L](R?{}:-0,1)!=I,F=m((function(){I.has(1)})),P=v((function(e){new x(e)})),U=!R&&m((function(){for(var e=new x,t=5;t--;)e[L](t,t);return!e.has(-0)}));P||((x=t((function(t,r){d(t,x,e);var n=y(new _,t,x);return null!=r&&h(r,S,n[L],n),n}))).prototype=E,E.constructor=x),(F||U)&&(A("delete"),A("has"),S&&A("get")),(U||C)&&A(L),R&&E.clear&&delete E.clear}else x=M.getConstructor(t,e,S,L),c(x.prototype,r),meta.NEED=!0;return T(x,e),w[e]=x,o(o.G+o.W+o.F*(x!=_),w),R||M.setStrong(x,e,S),x}},258:function(e,t,r){"use strict";var strong=r(231),n=r(223);e.exports=r(232)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=strong.getEntry(n(this,"Map"),e);return t&&t.v},set:function(e,t){return strong.def(n(this,"Map"),0===e?0:e,t)}},strong,!0)},259:function(e,t,r){r(150)("Uint32",4,(function(e){return function(data,t,r){return e(this,data,t,r)}}))},260:function(e,t,r){r(150)("Uint16",2,(function(e){return function(data,t,r){return e(this,data,t,r)}}))},261:function(e,t,r){r(150)("Int16",2,(function(e){return function(data,t,r){return e(this,data,t,r)}}))},262:function(e,t,r){r(150)("Int8",1,(function(e){return function(data,t,r){return e(this,data,t,r)}}))},263:function(e,t,r){var n=r(5);n(n.G+n.W+n.F*!r(120).ABV,{DataView:r(158).DataView})},264:function(e,t,r){r(150)("Uint8",1,(function(e){return function(data,t,r){return e(this,data,t,r)}}))},266:function(e,t,r){"use strict";r.r(t),r.d(t,"GLTFLoader",(function(){return l}));r(258),r(55);var n=r(37),o=(r(149),r(259),r(260),r(261),r(262),r(56),r(157),r(263),r(26),r(54),r(10),r(31),r(264),r(4)),l=function(){function e(e){o.Loader.call(this,e),this.dracoLoader=null,this.ddsLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,object){e[t]=object},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(o.Loader.prototype),{constructor:e,load:function(e,t,r,n){var l,c=this;l=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:o.LoaderUtils.extractUrlBase(e),c.manager.itemStart(e);var h=function(t){n?n(t):console.error(t),c.manager.itemError(e),c.manager.itemEnd(e)},d=new o.FileLoader(c.manager);d.setPath(this.path),d.setResponseType("arraybuffer"),d.setRequestHeader(this.requestHeader),"use-credentials"===c.crossOrigin&&d.setWithCredentials(!0),d.load(e,(function(data){try{c.parse(data,l,(function(r){t(r),c.manager.itemEnd(e)}),h)}catch(e){h(e)}}),r,h)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(e){return this.ddsLoader=e,this},parse:function(data,path,e,t){var content,n={};if("string"==typeof data)content=data;else if(o.LoaderUtils.decodeText(new Uint8Array(data,0,4))===f){try{n[r.KHR_BINARY_GLTF]=new T(data)}catch(e){return void(t&&t(e))}content=n[r.KHR_BINARY_GLTF].content}else content=o.LoaderUtils.decodeText(new Uint8Array(data));var m=JSON.parse(content);if(void 0===m.asset||m.asset.version[0]<2)t&&t(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(m.extensionsUsed)for(var i=0;i<m.extensionsUsed.length;++i){var v=m.extensionsUsed[i],S=m.extensionsRequired||[];switch(v){case r.KHR_LIGHTS_PUNCTUAL:n[v]=new c(m);break;case r.KHR_MATERIALS_CLEARCOAT:n[v]=new d;break;case r.KHR_MATERIALS_UNLIT:n[v]=new h;break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:n[v]=new R;break;case r.KHR_DRACO_MESH_COMPRESSION:n[v]=new y(m,this.dracoLoader);break;case r.MSFT_TEXTURE_DDS:n[v]=new l(this.ddsLoader);break;case r.KHR_TEXTURE_TRANSFORM:n[v]=new M;break;case r.KHR_MESH_QUANTIZATION:n[v]=new _;break;default:S.indexOf(v)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+v+'".')}}var x=new J(m,n,{path:path||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});x.fileLoader.setRequestHeader(this.requestHeader),x.parse(e,t)}}});var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function l(e){if(!e)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=r.MSFT_TEXTURE_DDS,this.ddsLoader=e}function c(e){this.name=r.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[r.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function h(){this.name=r.KHR_MATERIALS_UNLIT}function d(){this.name=r.KHR_MATERIALS_CLEARCOAT}c.prototype.loadLight=function(e){var t,r=this.lightDefs[e],n=new o.Color(16777215);void 0!==r.color&&n.fromArray(r.color);var l=void 0!==r.range?r.range:0;switch(r.type){case"directional":(t=new o.DirectionalLight(n)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new o.PointLight(n)).distance=l;break;case"spot":(t=new o.SpotLight(n)).distance=l,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},h.prototype.getMaterialType=function(){return o.MeshBasicMaterial},h.prototype.extendParams=function(e,t,r){var n=[];e.color=new o.Color(1,1,1),e.opacity=1;var l=t.pbrMetallicRoughness;if(l){if(Array.isArray(l.baseColorFactor)){var c=l.baseColorFactor;e.color.fromArray(c),e.opacity=c[3]}void 0!==l.baseColorTexture&&n.push(r.assignTexture(e,"map",l.baseColorTexture))}return Promise.all(n)},d.prototype.getMaterialType=function(){return o.MeshPhysicalMaterial},d.prototype.extendParams=function(e,t,r){var n=[],l=t.extensions[this.name];if(void 0!==l.clearcoatFactor&&(e.clearcoat=l.clearcoatFactor),void 0!==l.clearcoatTexture&&n.push(r.assignTexture(e,"clearcoatMap",l.clearcoatTexture)),void 0!==l.clearcoatRoughnessFactor&&(e.clearcoatRoughness=l.clearcoatRoughnessFactor),void 0!==l.clearcoatRoughnessTexture&&n.push(r.assignTexture(e,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),void 0!==l.clearcoatNormalTexture&&(n.push(r.assignTexture(e,"clearcoatNormalMap",l.clearcoatNormalTexture)),void 0!==l.clearcoatNormalTexture.scale)){var c=l.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new o.Vector2(c,c)}return Promise.all(n)};var f="glTF",m=1313821514,v=5130562;function T(data){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(data,0,12);if(this.header={magic:o.LoaderUtils.decodeText(new Uint8Array(data.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==f)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var t=new DataView(data,12),n=0;n<t.byteLength;){var l=t.getUint32(n,!0);n+=4;var c=t.getUint32(n,!0);if(n+=4,c===m){var h=new Uint8Array(data,12+n,l);this.content=o.LoaderUtils.decodeText(h)}else if(c===v){var d=12+n;this.body=data.slice(d,d+l)}n+=l}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function y(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function M(){this.name=r.KHR_TEXTURE_TRANSFORM}function S(e){o.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),r=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),n=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),l=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),c=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),h={specular:{value:(new o.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=h,this.onBeforeCompile=function(e){for(var o in h)e.uniforms[o]=h[o];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),e.fragmentShader=e.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_pars_fragment>",t),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_pars_fragment>",r),e.fragmentShader=e.fragmentShader.replace("#include <roughnessmap_fragment>",n),e.fragmentShader=e.fragmentShader.replace("#include <metalnessmap_fragment>",l),e.fragmentShader=e.fragmentShader.replace("#include <lights_physical_fragment>",c)},Object.defineProperties(this,{specular:{get:function(){return h.specular.value},set:function(e){h.specular.value=e}},specularMap:{get:function(){return h.specularMap.value},set:function(e){h.specularMap.value=e}},glossiness:{get:function(){return h.glossiness.value},set:function(e){h.glossiness.value=e}},glossinessMap:{get:function(){return h.glossinessMap.value},set:function(e){h.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function R(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return S},extendParams:function(e,t,r){var n=t.extensions[this.name];e.color=new o.Color(1,1,1),e.opacity=1;var l=[];if(Array.isArray(n.diffuseFactor)){var c=n.diffuseFactor;e.color.fromArray(c),e.opacity=c[3]}if(void 0!==n.diffuseTexture&&l.push(r.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new o.Color(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new o.Color(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var h=n.specularGlossinessTexture;l.push(r.assignTexture(e,"glossinessMap",h)),l.push(r.assignTexture(e,"specularMap",h))}return Promise.all(l)},createMaterial:function(e){var t=new S(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=o.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function _(){this.name=r.KHR_MESH_QUANTIZATION}function x(e,t,r,n){o.Interpolant.call(this,e,t,r,n)}y.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,o=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,c={},h={},d={};for(var f in l){var m=N[f]||f.toLowerCase();c[m]=l[f]}for(f in e.attributes){m=N[f]||f.toLowerCase();if(void 0!==l[f]){var v=r.accessors[e.attributes[f]],T=P[v.componentType];d[m]=T,h[m]=!0===v.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){n.decodeDracoFile(e,(function(e){for(var r in e.attributes){var n=e.attributes[r],o=h[r];void 0!==o&&(n.normalized=o)}t(e)}),c,d)}))}))},M.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},S.prototype=Object.create(o.MeshStandardMaterial.prototype),S.prototype.constructor=S,S.prototype.copy=function(source){return o.MeshStandardMaterial.prototype.copy.call(this,source),this.specularMap=source.specularMap,this.specular.copy(source.specular),this.glossinessMap=source.glossinessMap,this.glossiness=source.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},x.prototype=Object.create(o.Interpolant.prototype),x.prototype.constructor=x,x.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,o=e*n*3+n,i=0;i!==n;i++)t[i]=r[o+i];return t},x.prototype.beforeStart_=x.prototype.copySampleValue_,x.prototype.afterEnd_=x.prototype.copySampleValue_,x.prototype.interpolate_=function(e,t,r,n){for(var o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=2*c,d=3*c,td=n-t,p=(r-t)/td,f=p*p,m=f*p,v=e*d,T=v-d,y=-2*m+3*f,M=m-f,S=1-y,R=M-f+p,i=0;i!==c;i++){var _=l[T+i+c],x=l[T+i+h]*td,L=l[v+i+c],E=l[v+i]*td;o[i]=S*_+R*x+y*L+M*E}return o};var L=0,E=1,w=2,A=3,I=4,C=5,F=6,P={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},U={9728:o.NearestFilter,9729:o.LinearFilter,9984:o.NearestMipmapNearestFilter,9985:o.LinearMipmapNearestFilter,9986:o.NearestMipmapLinearFilter,9987:o.LinearMipmapLinearFilter},O={33071:o.ClampToEdgeWrapping,33648:o.MirroredRepeatWrapping,10497:o.RepeatWrapping},H={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},N={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},D={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},G={CUBICSPLINE:void 0,LINEAR:o.InterpolateLinear,STEP:o.InterpolateDiscrete},k="OPAQUE",B="MASK",K="BLEND",j={"image/png":o.RGBAFormat,"image/jpeg":o.RGBFormat};function V(e,path){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(path)&&/^\//.test(e)&&(path=path.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:path+e)}function X(e,object,t){for(var r in t.extensions)void 0===e[r]&&(object.userData.gltfExtensions=object.userData.gltfExtensions||{},object.userData.gltfExtensions[r]=t.extensions[r])}function z(object,e){void 0!==e.extras&&("object"===Object(n.a)(e.extras)?Object.assign(object.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function W(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var i=0,r=t.weights.length;i<r;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){var n=t.extras.targetNames;if(e.morphTargetInfluences.length===n.length){e.morphTargetDictionary={};for(i=0,r=n.length;i<r;i++)e.morphTargetDictionary[n[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Y(e){for(var t="",r=Object.keys(e).sort(),i=0,n=r.length;i<n;i++)t+=r[i]+":"+e[r[i]]+";";return t}function J(e,r,n){this.json=e||{},this.extensions=r||{},this.options=n||{},this.cache=new t,this.associations=new Map,this.primitiveCache={},this.textureLoader=new o.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new o.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function Q(e,t,r){var n=t.attributes,l=[];function c(t,n){return r.getDependency("accessor",t).then((function(t){e.setAttribute(n,t)}))}for(var h in n){var d=N[h]||h.toLowerCase();d in e.attributes||l.push(c(n[h],d))}if(void 0!==t.indices&&!e.index){var f=r.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));l.push(f)}return z(e,t),function(e,t,r){var n=t.attributes,l=new o.Box3;if(void 0!==n.POSITION){var c=(y=r.json.accessors[n.POSITION]).min,h=y.max;if(void 0!==c&&void 0!==h){l.set(new o.Vector3(c[0],c[1],c[2]),new o.Vector3(h[0],h[1],h[2]));var d=t.targets;if(void 0!==d){for(var f=new o.Vector3,m=new o.Vector3,i=0,v=d.length;i<v;i++){var T=d[i];if(void 0!==T.POSITION){var y;c=(y=r.json.accessors[T.POSITION]).min,h=y.max;void 0!==c&&void 0!==h?(m.setX(Math.max(Math.abs(c[0]),Math.abs(h[0]))),m.setY(Math.max(Math.abs(c[1]),Math.abs(h[1]))),m.setZ(Math.max(Math.abs(c[2]),Math.abs(h[2]))),f.max(m)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}l.expandByVector(f)}e.boundingBox=l;var M=new o.Sphere;l.getCenter(M.center),M.radius=l.min.distanceTo(l.max)/2,e.boundingSphere=M}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,r),Promise.all(l).then((function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,o=!1,i=0,l=t.length;i<l;i++){if(void 0!==(d=t[i]).POSITION&&(n=!0),void 0!==d.NORMAL&&(o=!0),n&&o)break}if(!n&&!o)return Promise.resolve(e);var c=[],h=[];for(i=0,l=t.length;i<l;i++){var d=t[i];if(n){var f=void 0!==d.POSITION?r.getDependency("accessor",d.POSITION):e.attributes.position;c.push(f)}if(o){f=void 0!==d.NORMAL?r.getDependency("accessor",d.NORMAL):e.attributes.normal;h.push(f)}}return Promise.all([Promise.all(c),Promise.all(h)]).then((function(t){var r=t[0],l=t[1];return n&&(e.morphAttributes.position=r),o&&(e.morphAttributes.normal=l),e.morphTargetsRelative=!0,e}))}(e,t.targets,r):e}))}function Z(e,t){var r=e.getIndex();if(null===r){var n=[],l=e.getAttribute("position");if(void 0===l)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var i=0;i<l.count;i++)n.push(i);e.setIndex(n),r=e.getIndex()}var c=r.count-2,h=[];if(t===o.TriangleFanDrawMode)for(i=1;i<=c;i++)h.push(r.getX(0)),h.push(r.getX(i)),h.push(r.getX(i+1));else for(i=0;i<c;i++)i%2==0?(h.push(r.getX(i)),h.push(r.getX(i+1)),h.push(r.getX(i+2))):(h.push(r.getX(i+2)),h.push(r.getX(i+1)),h.push(r.getX(i)));h.length/3!==c&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var d=e.clone();return d.setIndex(h),d}return J.prototype.parse=function(e,t){var r=this,n=this.json,o=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then((function(t){var l={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};X(o,l,n),z(l,n),e(l)})).catch(t)},J.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},o={},l=0,c=t.length;l<c;l++)for(var h=t[l].joints,i=0,d=h.length;i<d;i++)e[h[i]].isBone=!0;for(var f=0,m=e.length;f<m;f++){var v=e[f];void 0!==v.mesh&&(void 0===n[v.mesh]&&(n[v.mesh]=o[v.mesh]=0),n[v.mesh]++,void 0!==v.skin&&(r[v.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=o},J.prototype.getDependency=function(e,t){var n=e+":"+t,o=this.cache.get(n);if(!o){switch(e){case"scene":o=this.loadScene(t);break;case"node":o=this.loadNode(t);break;case"mesh":o=this.loadMesh(t);break;case"accessor":o=this.loadAccessor(t);break;case"bufferView":o=this.loadBufferView(t);break;case"buffer":o=this.loadBuffer(t);break;case"material":o=this.loadMaterial(t);break;case"texture":o=this.loadTexture(t);break;case"skin":o=this.loadSkin(t);break;case"animation":o=this.loadAnimation(t);break;case"camera":o=this.loadCamera(t);break;case"light":o=this.extensions[r.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,o)}return o},J.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,defs=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(defs.map((function(t,n){return r.getDependency(e,n)}))),this.cache.add(e,t)}return t},J.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var o=this.options;return new Promise((function(e,r){n.load(V(t.uri,o.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},J.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)}))},J.prototype.loadAccessor=function(e){var t=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var l=[];return void 0!==n.bufferView?l.push(this.getDependency("bufferView",n.bufferView)):l.push(null),void 0!==n.sparse&&(l.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),l.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(l).then((function(e){var l,c,h=e[0],d=H[n.type],f=P[n.componentType],m=f.BYTES_PER_ELEMENT,v=m*d,T=n.byteOffset||0,y=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,M=!0===n.normalized;if(y&&y!==v){var S=Math.floor(T/y),R="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+S+":"+n.count,_=t.cache.get(R);_||(l=new f(h,S*y,n.count*y/m),_=new o.InterleavedBuffer(l,y/m),t.cache.add(R,_)),c=new o.InterleavedBufferAttribute(_,d,T%y/m,M)}else l=null===h?new f(n.count*d):new f(h,T,n.count*d),c=new o.BufferAttribute(l,d,M);if(void 0!==n.sparse){var x=H.SCALAR,L=P[n.sparse.indices.componentType],E=n.sparse.indices.byteOffset||0,w=n.sparse.values.byteOffset||0,A=new L(e[1],E,n.sparse.count*x),I=new f(e[2],w,n.sparse.count*d);null!==h&&(c=new o.BufferAttribute(c.array.slice(),c.itemSize,c.normalized));for(var i=0,C=A.length;i<C;i++){var F=A[i];if(c.setX(F,I[i*d]),d>=2&&c.setY(F,I[i*d+1]),d>=3&&c.setZ(F,I[i*d+2]),d>=4&&c.setW(F,I[i*d+3]),d>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return c}))},J.prototype.loadTexture=function(e){var source,t=this,n=this.json,l=this.options,c=this.textureLoader,h=self.URL||self.webkitURL,d=n.textures[e],f=d.extensions||{},m=(source=f[r.MSFT_TEXTURE_DDS]?n.images[f[r.MSFT_TEXTURE_DDS].source]:n.images[d.source]).uri,v=!1;return void 0!==source.bufferView&&(m=t.getDependency("bufferView",source.bufferView).then((function(e){v=!0;var t=new Blob([e],{type:source.mimeType});return m=h.createObjectURL(t)}))),Promise.resolve(m).then((function(e){var n=l.manager.getHandler(e);return n||(n=f[r.MSFT_TEXTURE_DDS]?t.extensions[r.MSFT_TEXTURE_DDS].ddsLoader:c),new Promise((function(t,r){n.load(V(e,l.path),t,void 0,r)}))})).then((function(r){!0===v&&h.revokeObjectURL(m),r.flipY=!1,d.name&&(r.name=d.name),source.mimeType in j&&(r.format=j[source.mimeType]);var l=(n.samplers||{})[d.sampler]||{};return r.magFilter=U[l.magFilter]||o.LinearFilter,r.minFilter=U[l.minFilter]||o.LinearMipmapLinearFilter,r.wrapS=O[l.wrapS]||o.RepeatWrapping,r.wrapT=O[l.wrapT]||o.RepeatWrapping,t.associations.set(r,{type:"textures",index:e}),r}))},J.prototype.assignTexture=function(e,t,n){var l=this;return this.getDependency("texture",n.index).then((function(c){if(!c.isCompressedTexture)switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":c.format=o.RGBFormat}if(void 0===n.texCoord||0==n.texCoord||"aoMap"===t&&1==n.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+n.texCoord+" for texture "+t+" not yet supported."),l.extensions[r.KHR_TEXTURE_TRANSFORM]){var h=void 0!==n.extensions?n.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;if(h){var d=l.associations.get(c);c=l.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(c,h),l.associations.set(c,d)}}e[t]=c}))},J.prototype.assignFinalMaterial=function(e){var t=e.geometry,r=e.material,n=void 0!==t.attributes.tangent,l=void 0!==t.attributes.color,c=void 0===t.attributes.normal,h=!0===e.isSkinnedMesh,d=Object.keys(t.morphAttributes).length>0,f=d&&void 0!==t.morphAttributes.normal;if(e.isPoints){var m="PointsMaterial:"+r.uuid,v=this.cache.get(m);v||(v=new o.PointsMaterial,o.Material.prototype.copy.call(v,r),v.color.copy(r.color),v.map=r.map,v.sizeAttenuation=!1,this.cache.add(m,v)),r=v}else if(e.isLine){m="LineBasicMaterial:"+r.uuid;var T=this.cache.get(m);T||(T=new o.LineBasicMaterial,o.Material.prototype.copy.call(T,r),T.color.copy(r.color),this.cache.add(m,T)),r=T}if(n||l||c||h||d){m="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(m+="specular-glossiness:"),h&&(m+="skinning:"),n&&(m+="vertex-tangents:"),l&&(m+="vertex-colors:"),c&&(m+="flat-shading:"),d&&(m+="morph-targets:"),f&&(m+="morph-normals:");var y=this.cache.get(m);y||(y=r.clone(),h&&(y.skinning=!0),n&&(y.vertexTangents=!0),l&&(y.vertexColors=!0),c&&(y.flatShading=!0),d&&(y.morphTargets=!0),f&&(y.morphNormals=!0),this.cache.add(m,y),this.associations.set(y,this.associations.get(r))),r=y}r.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),r.normalScale&&!n&&(r.normalScale.y=-r.normalScale.y),r.clearcoatNormalScale&&!n&&(r.clearcoatNormalScale.y=-r.clearcoatNormalScale.y),e.material=r},J.prototype.loadMaterial=function(e){var t,n=this,l=this.json,c=this.extensions,h=l.materials[e],d={},f=h.extensions||{},m=[];if(f[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var v=c[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=v.getMaterialType(),m.push(v.extendParams(d,h,n))}else if(f[r.KHR_MATERIALS_UNLIT]){var T=c[r.KHR_MATERIALS_UNLIT];t=T.getMaterialType(),m.push(T.extendParams(d,h,n))}else{t=o.MeshStandardMaterial;var y=h.pbrMetallicRoughness||{};if(d.color=new o.Color(1,1,1),d.opacity=1,Array.isArray(y.baseColorFactor)){var M=y.baseColorFactor;d.color.fromArray(M),d.opacity=M[3]}void 0!==y.baseColorTexture&&m.push(n.assignTexture(d,"map",y.baseColorTexture)),d.metalness=void 0!==y.metallicFactor?y.metallicFactor:1,d.roughness=void 0!==y.roughnessFactor?y.roughnessFactor:1,void 0!==y.metallicRoughnessTexture&&(m.push(n.assignTexture(d,"metalnessMap",y.metallicRoughnessTexture)),m.push(n.assignTexture(d,"roughnessMap",y.metallicRoughnessTexture)))}!0===h.doubleSided&&(d.side=o.DoubleSide);var R=h.alphaMode||k;if(R===K?(d.transparent=!0,d.depthWrite=!1):(d.transparent=!1,R===B&&(d.alphaTest=void 0!==h.alphaCutoff?h.alphaCutoff:.5)),void 0!==h.normalTexture&&t!==o.MeshBasicMaterial&&(m.push(n.assignTexture(d,"normalMap",h.normalTexture)),d.normalScale=new o.Vector2(1,1),void 0!==h.normalTexture.scale&&d.normalScale.set(h.normalTexture.scale,h.normalTexture.scale)),void 0!==h.occlusionTexture&&t!==o.MeshBasicMaterial&&(m.push(n.assignTexture(d,"aoMap",h.occlusionTexture)),void 0!==h.occlusionTexture.strength&&(d.aoMapIntensity=h.occlusionTexture.strength)),void 0!==h.emissiveFactor&&t!==o.MeshBasicMaterial&&(d.emissive=(new o.Color).fromArray(h.emissiveFactor)),void 0!==h.emissiveTexture&&t!==o.MeshBasicMaterial&&m.push(n.assignTexture(d,"emissiveMap",h.emissiveTexture)),f[r.KHR_MATERIALS_CLEARCOAT]){var _=c[r.KHR_MATERIALS_CLEARCOAT];t=_.getMaterialType(),m.push(_.extendParams(d,{extensions:f},n))}return Promise.all(m).then((function(){var l;return l=t===S?c[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(d):new t(d),h.name&&(l.name=h.name),l.map&&(l.map.encoding=o.sRGBEncoding),l.emissiveMap&&(l.emissiveMap.encoding=o.sRGBEncoding),z(l,h),n.associations.set(l,{type:"materials",index:e}),h.extensions&&X(c,l,h),l}))},J.prototype.loadGeometries=function(e){var t=this,n=this.extensions,l=this.primitiveCache;function c(e){return n[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return Q(r,e,t)}))}for(var h,d,f=[],i=0,m=e.length;i<m;i++){var v,T=e[i],y=(d=void 0,(d=(h=T).extensions&&h.extensions[r.KHR_DRACO_MESH_COMPRESSION])?"draco:"+d.bufferView+":"+d.indices+":"+Y(d.attributes):h.indices+":"+Y(h.attributes)+":"+h.mode),M=l[y];if(M)f.push(M.promise);else v=T.extensions&&T.extensions[r.KHR_DRACO_MESH_COMPRESSION]?c(T):Q(new o.BufferGeometry,T,t),l[y]={primitive:T,promise:v},f.push(v)}return Promise.all(f)},J.prototype.loadMesh=function(e){for(var t,r=this,n=this.json.meshes[e],l=n.primitives,c=[],i=0,h=l.length;i<h;i++){var d=void 0===l[i].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new o.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:o.FrontSide})),t.DefaultMaterial):this.getDependency("material",l[i].material);c.push(d)}return c.push(r.loadGeometries(l)),Promise.all(c).then((function(t){for(var c=t.slice(0,t.length-1),h=t[t.length-1],d=[],i=0,f=h.length;i<f;i++){var m,v=h[i],T=l[i],y=c[i];if(T.mode===I||T.mode===C||T.mode===F||void 0===T.mode)!0!==(m=!0===n.isSkinnedMesh?new o.SkinnedMesh(v,y):new o.Mesh(v,y)).isSkinnedMesh||m.geometry.attributes.skinWeight.normalized||m.normalizeSkinWeights(),T.mode===C?m.geometry=Z(m.geometry,o.TriangleStripDrawMode):T.mode===F&&(m.geometry=Z(m.geometry,o.TriangleFanDrawMode));else if(T.mode===E)m=new o.LineSegments(v,y);else if(T.mode===A)m=new o.Line(v,y);else if(T.mode===w)m=new o.LineLoop(v,y);else{if(T.mode!==L)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+T.mode);m=new o.Points(v,y)}Object.keys(m.geometry.morphAttributes).length>0&&W(m,n),m.name=n.name||"mesh_"+e,h.length>1&&(m.name+="_"+i),z(m,n),r.assignFinalMaterial(m),d.push(m)}if(1===d.length)return d[0];var M=new o.Group;for(i=0,f=d.length;i<f;i++)M.add(d[i]);return M}))},J.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],n=r[r.type];if(n)return"perspective"===r.type?t=new o.PerspectiveCamera(o.MathUtils.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(t=new o.OrthographicCamera(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(t.name=r.name),z(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},J.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))},J.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],n=[],l=[],c=[],h=[],i=0,d=t.channels.length;i<d;i++){var f=t.channels[i],m=t.samplers[f.sampler],v=f.target,T=void 0!==v.node?v.node:v.id,input=void 0!==t.parameters?t.parameters[m.input]:m.input,output=void 0!==t.parameters?t.parameters[m.output]:m.output;r.push(this.getDependency("node",T)),n.push(this.getDependency("accessor",input)),l.push(this.getDependency("accessor",output)),c.push(m),h.push(v)}return Promise.all([Promise.all(r),Promise.all(n),Promise.all(l),Promise.all(c),Promise.all(h)]).then((function(r){for(var n=r[0],l=r[1],c=r[2],h=r[3],d=r[4],f=[],i=0,m=n.length;i<m;i++){var v=n[i],T=l[i],y=c[i],M=h[i],S=d[i];if(void 0!==v){var R;switch(v.updateMatrix(),v.matrixAutoUpdate=!0,D[S.path]){case D.weights:R=o.NumberKeyframeTrack;break;case D.rotation:R=o.QuaternionKeyframeTrack;break;case D.position:case D.scale:default:R=o.VectorKeyframeTrack}var _=v.name?v.name:v.uuid,L=void 0!==M.interpolation?G[M.interpolation]:o.InterpolateLinear,E=[];D[S.path]===D.weights?v.traverse((function(object){!0===object.isMesh&&object.morphTargetInfluences&&E.push(object.name?object.name:object.uuid)})):E.push(_);var w=y.array;if(y.normalized){var A;if(w.constructor===Int8Array)A=1/127;else if(w.constructor===Uint8Array)A=1/255;else if(w.constructor==Int16Array)A=1/32767;else{if(w.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");A=1/65535}for(var I=new Float32Array(w.length),C=0,F=w.length;C<F;C++)I[C]=w[C]*A;w=I}for(C=0,F=E.length;C<F;C++){var track=new R(E[C]+"."+D[S.path],T.array,w,L);"CUBICSPLINE"===M.interpolation&&(track.createInterpolant=function(e){return new x(this.times,this.values,this.getValueSize()/3,e)},track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),f.push(track)}}}var P=t.name?t.name:"animation_"+e;return new o.AnimationClip(P,void 0,f)}))},J.prototype.loadNode=function(e){var t,n=this.json,l=this.extensions,c=this,h=n.meshReferences,d=n.meshUses,f=n.nodes[e];return(t=[],void 0!==f.mesh&&t.push(c.getDependency("mesh",f.mesh).then((function(e){var t;if(h[f.mesh]>1){var r=d[f.mesh]++;(t=e.clone()).name+="_instance_"+r}else t=e;return void 0!==f.weights&&t.traverse((function(e){if(e.isMesh)for(var i=0,t=f.weights.length;i<t;i++)e.morphTargetInfluences[i]=f.weights[i]})),t}))),void 0!==f.camera&&t.push(c.getDependency("camera",f.camera)),f.extensions&&f.extensions[r.KHR_LIGHTS_PUNCTUAL]&&void 0!==f.extensions[r.KHR_LIGHTS_PUNCTUAL].light&&t.push(c.getDependency("light",f.extensions[r.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(t)).then((function(t){var r;if((r=!0===f.isBone?new o.Bone:t.length>1?new o.Group:1===t.length?t[0]:new o.Object3D)!==t[0])for(var i=0,n=t.length;i<n;i++)r.add(t[i]);if(f.name&&(r.userData.name=f.name,r.userData.mesh=f.mesh,r.name=o.PropertyBinding.sanitizeNodeName(f.name)),z(r,f),f.extensions&&X(l,r,f),void 0!==f.matrix){var h=new o.Matrix4;h.fromArray(f.matrix),r.applyMatrix4(h)}else void 0!==f.translation&&r.position.fromArray(f.translation),void 0!==f.rotation&&r.quaternion.fromArray(f.rotation),void 0!==f.scale&&r.scale.fromArray(f.scale);return c.associations.set(r,{type:"nodes",index:e}),r}))},J.prototype.loadScene=function(){function e(t,r,n,l){var c=n.nodes[t];return l.getDependency("node",t).then((function(e){return void 0===c.skin?e:l.getDependency("skin",c.skin).then((function(e){for(var r=[],i=0,n=(t=e).joints.length;i<n;i++)r.push(l.getDependency("node",t.joints[i]));return Promise.all(r)})).then((function(r){return e.traverse((function(e){if(e.isMesh){for(var n=[],l=[],c=0,h=r.length;c<h;c++){var d=r[c];if(d){n.push(d);var f=new o.Matrix4;void 0!==t.inverseBindMatrices&&f.fromArray(t.inverseBindMatrices.array,16*c),l.push(f)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[c])}e.bind(new o.Skeleton(n,l),e.matrixWorld)}})),e}));var t})).then((function(t){r.add(t);var o=[];if(c.children)for(var h=c.children,i=0,d=h.length;i<d;i++){var f=h[i];o.push(e(f,t,n,l))}return Promise.all(o)}))}return function(t){var r=this.json,n=this.extensions,l=this.json.scenes[t],c=new o.Group;l.name&&(c.name=l.name),z(c,l),l.extensions&&X(n,c,l);for(var h=l.nodes||[],d=[],i=0,f=h.length;i<f;i++)d.push(e(h[i],c,r,this));return Promise.all(d).then((function(){return c}))}}(),e}()}}]);